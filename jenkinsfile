pipeline{
    agent any

    stages{

        stage('Make directory'){
            steps{
                sh '''
                    #!/bin/bash
                    DIR="/home/alex0872m/elevator2"

                    if [ -d "$DIR" ]
                    then
                        ### Take action if $DIR exists ###
                        cd /home/alex0872m/elevator2
                    else
                        ###  Control will jump here if $DIR does NOT exists ###
                        mkdir elevator2
                        cd /home/alex0872m/elevator2
                    exit 1
                    fi
                '''
            }
        }

        stage('Cloning Git') { 
            steps{
                sh '''
                    #!/bin/bash

                    DIR = "/home/alex0872m/elevator2"
                    if [ "$(ls -A $DIR)" ]
                    then
                        echo "Not Empty"
                    else
                        echo "Empty"
                        cd /home/alex0872m/elevator2
                        git init
                        git clone https://github.com/a0morshna/elevator-task.git
                    fi
                '''
            }
        } 

        stage('Install wheel'){
            steps{
                sh'''
                    version=$(python3 --version 2>&1 | grep -Po '(?<=Python )(.+)')
                    if [ -z "$version" ]
                    then
                        echo "No Python!"
                        sudo apt install -y python3-pip
                        python3 -m pip install -U wheel setuptools
                    fi
                '''
            }
        }
        
        stage('Make wheel'){
            steps{
                sh "python3 /home/alex0872m/elevator2/elevator-task/code/Elevator.py bdist_wheel --universal"
            }
        }

    }
}